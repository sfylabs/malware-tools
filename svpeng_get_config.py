# Download and decryption tool for Svpeng config
# @author  @SfyLabs | www.csd.am
# @version 1.0

import base64

import requests
from Cryptodome.Cipher import AES
from random import randint

url = 'http://217.182.174.92/jack.zip'
key = b'0B6T51SI9X8H3D0L'

def random_with_N_digits(n):
    range_start = 10**(n-1)
    range_end = (10**n)-1
    return randint(range_start, range_end)

def decrypt(value):
    cipher = AES.new(key, AES.MODE_ECB)
    return cipher.decrypt(base64.b64decode(value))


if __name__ == '__main__':
    deviceId = random_with_N_digits(15)
    session = requests.Session()

    paramsPost = {'_AUTH': deviceId}
    headers = {'User-Agent': 'Dalvik/2.1.0 (Linux; U; Android 5.0.2; AndroidSDK built for x86 Build/LSY66K)',
               'Connection': 'close',
               'Content-Type': 'application/x-www-form-urlencoded'}

    response = session.post(url, data=paramsPost, headers=headers)

    print(decrypt(response.content).decode('utf-8'))
